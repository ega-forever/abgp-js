sudo: required
dist: bionic
os: linux
group: stable
language: node_js
node_js: 16.14.0

before_install:
  - sudo apt-get update
  - sudo apt-get install python2.7 git -y
  - npm install -g node-gyp

install:
  - ls $TRAVIS_BUILD_DIR
  - cd $TRAVIS_BUILD_DIR/abgp-js/abgp && npm install && npm run tsc:build
  - cd $TRAVIS_BUILD_DIR/abgp-js/implementations/crypto/bnelliptic && npm install && npm run build_dist
  - cd $TRAVIS_BUILD_DIR/abgp-js/implementations/crypto/plain && npm install && npm run build_dist
  - cd $TRAVIS_BUILD_DIR/abgp-js/implementations/node/rpc && npm install && npm run build_dist
  - cd $TRAVIS_BUILD_DIR/abgp-js/implementations/node/tcp && npm install && npm run build_dist
  - cd $TRAVIS_BUILD_DIR/abgp-js/implementations/storage/plain && npm install && npm run build_dist

script:
  - cd $TRAVIS_BUILD_DIR/abgp-js/abgp && mkdir dump && npm test

notifications:
  email: false

cache:
  directories:
    - node_modules